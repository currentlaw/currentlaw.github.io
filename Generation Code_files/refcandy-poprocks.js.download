(function(){(function(doc){var body,buttonDiv,command,div,iframe,key,parentOverflow,querystring,url,value,widgetLocation,widgetURL;command=function(a,b){return JSON.stringify({cmd:a,options:b})},div=doc.getElementById("refcandy-poprocks"),body=doc.getElementsByTagName("body")[0];if(div){body&&body.appendChild(div),widgetLocation=div.getAttribute("data-location"),/^(left|right)$/.test(widgetLocation)===!1&&(widgetLocation="right"),buttonDiv=doc.createElement("div"),buttonDiv.style.cssText=widgetLocation+": 10px; bottom: 0px; width: 290px; height: 0px; visibility: visible; margin: 0px; padding: 0px; border: 0px; background-color: transparent; overflow: hidden; position: fixed; z-index: 2147483647; background-position: initial initial; background-repeat: initial initial;",iframe=doc.createElement("iframe"),widgetURL=window.location.protocol+"//portal.referralcandy.com",url=widgetURL+"/widgets/poprocks/"+div.getAttribute("data-id")+"?",querystring={};if(div.getAttribute("data-minimized")==="yes"||div.getAttribute("data-minimized")==="true")querystring.minimized="yes";if(div.getAttribute("data-branding")==="no"||div.getAttribute("data-branding")==="false")querystring.no_branding="yes";div.hasAttribute("data-version")&&(querystring.version=div.getAttribute("data-version"));for(key in querystring)value=querystring[key],url+=key+"="+encodeURIComponent(value)+"&";return iframe.src=url,iframe.allowFullscreen=!0,iframe.frameBorder=0,iframe.scrolling="no",iframe.style.cssText="background-color: transparent; vertical-align: text-bottom; position: relative; width: 100%; height: 100%; margin: 0px; overflow: hidden;",buttonDiv.appendChild(iframe),div.appendChild(buttonDiv),parentOverflow=document.querySelector("body").style.overflow,iframe.onload=function(){return iframe.contentWindow.postMessage("init",widgetURL),iframe.contentWindow.postMessage(command("init",{height:document.documentElement.clientHeight,width:document.documentElement.clientWidth,location:widgetLocation}),widgetURL)},window.addEventListener("message",function(event){var action,jsonParse,results,style,style_name,styles;if(event.origin!==widgetURL)return;jsonParse=JSON&&JSON.parse||function(strJSON){return eval("(function(){return "+strJSON+";})()")},action=jsonParse(event.data);switch(action.cmd){case"update_style":styles=action.options,results=[];for(style_name in styles)style=styles[style_name],results.push(buttonDiv.style[style_name]=style);return results;case"disable_parent_scroll":return doc.querySelector("body").style.overflow="hidden";case"enable_parent_scroll":return doc.querySelector("body").style.overflow=parentOverflow;case"click_custom_uri":return window.location=action.options.location}}),window.addEventListener("resize",function(a){var b;return b={height:a.target.innerHeight,width:a.target.innerWidth},iframe.contentWindow.postMessage(command("resize",b),widgetURL)})}})(document)}).call(this);